<% if (user) { %>
  <%-include("partials/userHeader")-%>
<% } else { %>
  <%-include("partials/header")-%>
<% } %>

<section class="container">
  <div class="row justify-content-center mt-5">
    <div class="col-6">
      <h2><%=listing.title%></h2>
      <div>Posted by: <a href="/publicProfile/<%=listing.user%>" class="link-secondary"><%=employer.name%></a></div>
        <% if (listing.image) { %>
          <img class="img-fluid" src="<%= listing.image%>">
        <% } else {%>
          <img class="img-fluid" src="/imgs/default-post-pic.jpg" alt="default post pic">
        <% } %>
    </div>
    <div class="col-3 mt-5">
      <h4><%=listing.location%></h4>
      <h3><%=listing.company%></h3>
      <h3><%=listing.number%></h3>
      <h3><%=listing.address%></h3>
      <h5><%=listing.site%></h5>
      <h2><%=listing.description%></h2>
    </div>
  </div>
</section>
<!-- Questions Accordian -->
<section id="questions" class="p-5">
  <div class="container">
    <h2 class="text-center mb-4">Questions About The Job</h2>
    <% if (!questions.length) { %>
      <span class="text-center">There are currently no questions about this listing.</span>
    <% } %>
    <div class="accordion accordion-flush" id="questions">
      <% for(let i=0; i<questions.length; i++) {%>
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#question-<%=i%>"
            >
              <div><%=questions[i].question%></div>
            </button>
          </h2>
          <div
            id="question-<%=i%>"
            class="accordion-collapse collapse"
            data-bs-parent="#questions"
          >
            <div class="accordion-body">
              <div>
                Asked by: <a href="/publicProfile/<%=questions[i].user%>" class="link-secondary"><%=seeker.name%></a>
              </div>
              <%if (questions[i].answer != undefined){ %>
                <%=questions[i].answer%>
              <%} else {%>
                This question has not been answered yet.
              <% } %>
            </div>
          </div>
        </div>
      <% } %>
    </div>
  </div>
</section>

<!-- Signup Modal -->
<div class="modal fade" id="signup" tabindex="-1" aria-labelledby="signupLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="signupLabel">Signup</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%- include("signup") -%>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Submit</button>
      </div>
    </div>
  </div>
</div>
<%- include("partials/footer") -%>